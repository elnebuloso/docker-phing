<?xml version="1.0" encoding="UTF-8"?>


<project default="project:version:commit">


    <property name="projectVersionCommitDescription" value="commit the project version back to the repository" override="true"/>
    <property name="createTag" value="1"/>


    <target name="project:version:commit:help">
        <echo message="${projectVersionCommitDescription}"/>

        <echo message=""/>
        <echo message="property     value"/>
        <echo message="----------------------------------------------------------------------------------------------------"/>
        <echo message="createTag    ${createTag} [1|0]"/>
    </target>


    <target name="project:version:commit" depends="project:version:commit:before, project:version:commit:main, project:version:commit:after">
        <echo message="successful"/>
    </target>


    <target name="project:version:commit:before" hidden="true">
        <echo message="no actions defined"/>
    </target>


    <target name="project:version:commit:after" hidden="true">
        <echo message="no actions defined"/>
    </target>


    <target name="project:version:commit:main">
        <exec command="git pull origin master" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>
        <exec command="git add VERSION" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>
        <exec command="git commit -m &quot;git:auto:version ${projectVersion}&quot;" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>
        <exec command="git push origin HEAD:master" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>

        <if>
            <equals arg1="${createTag}" arg2="1"/>
            <then>
                <exec command="git tag -f -a ${projectVersion} -m &quot;phing project:version:commit tagging&quot;" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>
                <exec command="git push origin ${projectVersion} --force" passthru="true" checkreturn="true" level="info" dir="${projectRoot}"/>
            </then>
        </if>
    </target>


</project>