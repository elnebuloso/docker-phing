<?xml version="1.0" encoding="UTF-8"?>


<project name="commons">


    <property name="phingCommonsRoot" value="/srv/phing"/>


    <loadfile property="phingCommonsVersion" file="/srv/VERSION"/>
    <php function="trim" returnProperty="phingCommonsVersion" level="debug">
        <param value="${phingCommonsVersion}"/>
    </php>


    <php function="dirname" returnProperty="projectRoot" level="debug">
        <param value="${phing.file}"/>
    </php>
    <resolvepath propertyName="projectRoot" file="${projectRoot}"/>


    <loadfile property="projectVersion" file="${projectRoot}/VERSION"/>
    <php function="trim" returnProperty="projectVersion" level="debug">
        <param value="${projectVersion}"/>
    </php>


    <property name="projectFolderMain" value="main"/>
    <property name="projectFolderMainComposer" value=""/>
    <property name="projectFolderMainCompass" value=""/>
    <property name="projectFolderMainNpm" value=""/>
    <property name="projectFolderBuild" value="build"/>


    <property name="project.dir.main" value="${projectRoot}/${projectFolderMain}"/>
    <property name="project.dir.main.composer" value="${projectRoot}/${projectFolderMain}/${projectFolderMainComposer}"/>
    <property name="project.dir.main.compass" value="${projectRoot}/${projectFolderMain}/${projectFolderMainCompass}"/>
    <property name="project.dir.main.npm" value="${projectRoot}/${projectFolderMain}/${projectFolderMainNpm}"/>
    <property name="project.dir.build" value="${projectRoot}/${projectFolderBuild}"/>
    <property name="project.dir.build.tmp" value="${projectRoot}/${projectFolderBuild}/tmp"/>
    <property name="project.dir.build.dist" value="${projectRoot}/${projectFolderBuild}/dist"/>
    <property name="project.dir.build.reports" value="${projectRoot}/${projectFolderBuild}/reports"/>


    <resolvepath propertyName="project.dir.main" file="${project.dir.main}"/>
    <resolvepath propertyName="project.dir.main.composer" file="${project.dir.main.composer}"/>
    <resolvepath propertyName="project.dir.main.compass" file="${project.dir.main.compass}"/>
    <resolvepath propertyName="project.dir.main.npm" file="${project.dir.main.npm}"/>
    <resolvepath propertyName="project.dir.build" file="${project.dir.build}"/>
    <resolvepath propertyName="project.dir.build.tmp" file="${project.dir.build.tmp}"/>
    <resolvepath propertyName="project.dir.build.dist" file="${project.dir.build.dist}"/>
    <resolvepath propertyName="project.dir.build.reports" file="${project.dir.build.reports}"/>


    <autoloader autoloaderpath="${phingCommonsRoot}/vendor/autoload.php"/>
    <taskdef classname="\elnebuloso\Phing\PHPMetrics1DirectoriesTask" name="my-php-metrics1-directories"/>
    <taskdef classname="\elnebuloso\Phing\PHPMetrics2DirectoriesTask" name="my-php-metrics2-directories"/>


    <import file="${phingCommonsRoot}/targets/bundle.xml"/>
    <import file="${phingCommonsRoot}/targets/clean.xml"/>
    <import file="${phingCommonsRoot}/targets/compass.xml"/>
    <import file="${phingCommonsRoot}/targets/composer.xml"/>
    <import file="${phingCommonsRoot}/targets/docker.xml"/>
    <import file="${phingCommonsRoot}/targets/git.xml"/>
    <import file="${phingCommonsRoot}/targets/init.xml"/>
    <import file="${phingCommonsRoot}/targets/npm.xml"/>
    <import file="${phingCommonsRoot}/targets/project.xml"/>
    <import file="${phingCommonsRoot}/targets/report.xml"/>
    <import file="${phingCommonsRoot}/targets/test.xml"/>


    <fail unless="project.name" message="missing project.name"/>
    <fail unless="projectVersion" message="missing projectVersion"/>


    <target name="commons:help:version">
        <echo message="----------------------------------------------------------------------------------------------------"/>
        <echo message="phing commons version: ${phingCommonsVersion}"/>
        <echo message="----------------------------------------------------------------------------------------------------"/>
    </target>


    <target name="commons:help" depends="commons:help:version, bundle:help, clean:help, compass:help, composer:help, docker:help, git:help, init:help, npm:help, report:help, test:help, project:help"/>


</project>
