<?xml version="1.0" encoding="UTF-8"?>


<project name="commons">


    <property name="phing.commons.root" value="/srv/phing"/>


    <loadfile property="phing.commons.version" file="/srv/VERSION"/>
    <php function="trim" returnProperty="phing.commons.version" level="debug">
        <param value="${phing.commons.version}"/>
    </php>


    <php function="dirname" returnProperty="project.root" level="debug">
        <param value="${phing.file}"/>
    </php>
    <resolvepath propertyName="project.root" file="${project.root}"/>


    <loadfile property="project.version" file="${project.root}/VERSION"/>
    <php function="trim" returnProperty="project.version" level="debug">
        <param value="${project.version}"/>
    </php>


    <property name="project.folder.main" value="main"/>
    <property name="project.folder.main.composer" value=""/>
    <property name="project.folder.main.compass" value=""/>
    <property name="project.folder.main.npm" value=""/>
    <property name="project.folder.build" value="build"/>


    <property name="project.dir.main" value="${project.root}/${project.folder.main}"/>
    <property name="project.dir.main.composer" value="${project.root}/${project.folder.main}/${project.folder.main.composer}"/>
    <property name="project.dir.main.compass" value="${project.root}/${project.folder.main}/${project.folder.main.compass}"/>
    <property name="project.dir.main.npm" value="${project.root}/${project.folder.main}/${project.folder.main.npm}"/>
    <property name="project.dir.build" value="${project.root}/${project.folder.build}"/>
    <property name="project.dir.build.tmp" value="${project.root}/${project.folder.build}/tmp"/>
    <property name="project.dir.build.dist" value="${project.root}/${project.folder.build}/dist"/>
    <property name="project.dir.build.reports" value="${project.root}/${project.folder.build}/reports"/>


    <resolvepath propertyName="project.dir.main" file="${project.dir.main}"/>
    <resolvepath propertyName="project.dir.main.composer" file="${project.dir.main.composer}"/>
    <resolvepath propertyName="project.dir.main.compass" file="${project.dir.main.compass}"/>
    <resolvepath propertyName="project.dir.main.npm" file="${project.dir.main.npm}"/>
    <resolvepath propertyName="project.dir.build" file="${project.dir.build}"/>
    <resolvepath propertyName="project.dir.build.tmp" file="${project.dir.build.tmp}"/>
    <resolvepath propertyName="project.dir.build.dist" file="${project.dir.build.dist}"/>
    <resolvepath propertyName="project.dir.build.reports" file="${project.dir.build.reports}"/>


    <autoloader autoloaderpath="${phing.commons.root}/vendor/autoload.php"/>
    <taskdef classname="\elnebuloso\Phing\PHPMetrics1DirectoriesTask" name="my-php-metrics1-directories"/>
    <taskdef classname="\elnebuloso\Phing\PHPMetrics2DirectoriesTask" name="my-php-metrics2-directories"/>


    <import file="${phing.commons.root}/targets/bundle.xml"/>
    <import file="${phing.commons.root}/targets/clean.xml"/>
    <import file="${phing.commons.root}/targets/compass.xml"/>
    <import file="${phing.commons.root}/targets/composer.xml"/>
    <import file="${phing.commons.root}/targets/docker.xml"/>
    <import file="${phing.commons.root}/targets/git.xml"/>
    <import file="${phing.commons.root}/targets/init.xml"/>
    <import file="${phing.commons.root}/targets/npm.xml"/>
    <import file="${phing.commons.root}/targets/project.xml"/>
    <import file="${phing.commons.root}/targets/report.xml"/>
    <import file="${phing.commons.root}/targets/test.xml"/>


    <fail unless="project.name" message="missing project.name"/>
    <fail unless="project.version" message="missing project.version"/>


    <target name="commons:help:version">
        <echo message="----------------------------------------------------------------------------------------------------"/>
        <echo message="phing commons version: ${phing.commons.version}"/>
        <echo message="----------------------------------------------------------------------------------------------------"/>
    </target>


    <target name="commons:help" depends="commons:help:version, bundle:help, clean:help, compass:help, composer:help, docker:help, git:help, init:help, npm:help, report:help, test:help, project:help"/>


</project>
